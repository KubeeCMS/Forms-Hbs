function GFOwnerSetting(){var o=jQuery;this.init=function(){this.initOwner(),new GFConditionsSetting},this.initOwner=function(){var t=this;o("#contact_owner0, #contact_owner1, #contact_owner2").on("change",function(){t.toggleOwner(!0)}),this.toggleOwner(!1)},this.toggleOwner=function(t){o("#gaddon-setting-row-contact_owner_conditional, #gaddon-setting-row-contact_owner_select").hide();var e=o("input[name='_gaddon_setting_contact_owner']:checked").val();"none"!=e?(o(".contact_owner_section").is(":hidden")&&(t?o(".contact_owner_section").slideDown():o(".contact_owner_section").show()),o("#gaddon-setting-row-contact_owner_"+e).show()):t?o(".contact_owner_section").slideUp():o(".contact_owner_section").hide()},this.init()}function GFConditionsSetting(){var s=jQuery;this.$element=jQuery("#gform_conditions_setting"),this.fieldId="conditions",this.fieldName="_gaddon_setting_conditions",this.options=null,this.init=function(){var t,e,r=this;this.options={fieldName:this.fieldName,fieldId:this.fieldId,fields:gform_hubspot_owner_settings_strings.fields,owners:gform_hubspot_owner_settings_strings.owners,imagesURL:gf_vars.baseUrl+"/images",items:this.getItems(),operatorStrings:{is:"is",isnot:"isNot",">":"greaterThan","<":"lessThan",contains:"contains",starts_with:"startsWith",ends_with:"endsWith"}},e='<thead><tr><th>{0}</th><th colspan="3">{1}</th></tr></thead>'.format(gform_hubspot_owner_settings_strings.assign_to,gform_hubspot_owner_settings_strings.condition),t='<table class="gform-routings">{0}<tbody class="repeater">{1}</tbody></table>'.format(e,this.getNewRow());var o=s(t);o.find(".repeater").repeater({limit:0,items:this.options.items,addButtonMarkup:'<i class="gficon-add"></i>',removeButtonMarkup:'<i class="gficon-subtract"></i>',callbacks:{save:function(t,e){s("#"+r.options.fieldId).val(s.toJSON(e))},beforeAdd:function(t,e,o){o.owner&&e.find(".gform-routing-owners").val(o.owner);var i=e.find(".gform-routing-field").first();i.value=o.fieldId,r.changeField(i);var n=e.find(".gform-routing-operator").first();n.value=o.operator,r.changeOperator(n),e.find(".gform-routing-value").val(o.value)}}}).on("change",".gform-routing-field",function(t){r.changeField(this)}).on("change",".gform-routing-operator",function(){r.changeOperator(this)}),this.$element.append(o)},this.getNewRow=function(){var t=[];return t.push("<td>{0}</td>".format(this.getOwners())),t.push("<td>{0}</td>".format(this.getFields())),t.push("<td>{0}</td>".format(this.getOperators(this.options.fields[0]))),t.push("<td>{0}</td>".format(this.getValues())),t.push("<td>{buttons}</td>"),'<tr class="gform-routing-row">{0}</tr>'.format(t.join(""))},this.getOwners=function(){var t,e=this.options.owners,o='<select class="gform-routing-owners owner_{i}">';for(t=0;t<e.length;t++)o+='<option value="{0}">{1}</option>'.format(e[t].value,e[t].label);return o+="</select>"},this.getFields=function(){var t,e,o,i,n,r,s,a,l=[],f=this.options.fields;for(l.push('<select class="gform-routing-field fieldId_{i}" >'),t=0;t<f.length;t++)if(o=f[t].key,f[t].group){for(r=f[t].text,a=f[t].filters.length,s=[],e=0;e<a;e++)n=f[t].filters[e].text,i=f[t].filters[e].key,s.push('<option value="{0}">{1}</option>'.format(i,n));l.push('<optgroup label="{0}">{1}</optgroup>'.format(r,s.join("")))}else n=f[t].text,l.push('<option value="{0}">{1}</option>'.format(o,n));return l.push("</select>"),l.join("")},this.changeOperator=function(t){var e=s(t),o=e.closest("tr").find(".repeater-buttons").find(".add-item ").data("index"),i=e.closest("tr").find(".gform-routing-field"),n=this.getFilter(i.value);n&&e.closest("tr").find(".gform-routing-value").replaceWith(this.getValues(n,t.value,o))},this.changeField=function(t){var e=this.getFilter(t.value);if(e){var o=s(t),i=o.closest("tr").find(".repeater-buttons").find(".add-item ").data("index");o.closest("tr").find(".gform-routing-value").replaceWith(this.getValues(e,null,i)),o.closest("tr").find(".gform-filter-type").val(e.type).change();var n=s(this.getOperators(e,i));o.closest("tr").find(".gform-routing-operator").replaceWith(n),o.closest("tr").find(".gform-routing-operator").change()}},this.getOperators=function(t,e){null==e&&(e="{i}");var o,i,n=this.options.operatorStrings,r='<select class="gform-routing-operator operator_{0}">'.format(e);if(t)for(o=0;o<t.operators.length;o++)i=t.operators[o],r+='<option value="{0}">{1}</option>'.format(i,gf_vars[n[i]]);return r+="</select>"},this.getValues=function(t,e,o){var i,n,r,s,a="";if(null==o&&(o="{i}"),t&&t.values&&"contains"!=e){for(i=0;i<t.values.length;i++)n=t.values[i].value,r=t.values[i].text,a+='<option value="{0}">{1}</option>'.format(n,r);s='<select class="gform-routing-value value_{0}">{1}</select>'.format(o,a)}else s='<input type="text" value="" class="gform-routing-value value_{0}" />'.format(o);return s},this.getFilter=function(t){var e=this.options.fields;if(t)for(var o=0;o<e.length;o++){if(t==e[o].key)return e[o];if(e[o].group)for(var i=0;i<e[o].filters.length;i++)if(t==e[o].filters[i].key)return e[o].filters[i]}},this.selected=function(t,e){return t==e?'selected="selected"':""},this.getItems=function(){var t=s("#"+this.fieldId).val();return t?s.parseJSON(t):[{owner:"",fieldId:"0",operator:"is",value:""}]},this.init(),String.prototype.format=function(){var o=arguments;return this.replace(/{(\d+)}/g,function(t,e){return void 0!==o[e]?o[e]:t})}}jQuery(document).ready(function(){new GFOwnerSetting});